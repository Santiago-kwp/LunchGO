# 리마인더 트러블슈팅 기록

## 문제 1: 사용자가 페이지를 닫으면 리마인더가 발송되지 않음

### 증상
- 예약 후 브라우저를 닫으면 리마인더 문자 미발송
- 프론트 기반 트리거 방식에서만 발생

### 원인
- 리마인더 발송이 프론트 이벤트에 의존하고 있었음

### 해결
- 서버 스케줄러 기반 리마인더 발송 구조로 변경

### 해결 과정
- 프론트 트리거 제거
- 서버에서 주기적으로 발송 대상 조회하도록 수정
- 사용자 상태와 무관하게 알림 발송 확인


## 문제 2: 리마인더 문자가 여러 번 발송됨

### 증상
- 동일 예약에 대해 리마인더 문자가 중복 발송됨
- 서버 재시작 또는 스케줄러 재실행 시 재현

### 원인
- 발송 여부를 판단하는 기준이 없음
- 스케줄러 실행마다 동일 대상이 다시 조회됨

### 해결
- 발송 완료 여부를 DB에 기록
- 발송 전 상태 체크 후 한 번만 발송

### 해결 과정
- 발송 로그 분석을 통해 중복 발송 확인
- 발송 상태 컬럼 추가
- 중복 발송 재현 불가 상태 확인


## 문제 3: 리마인더 링크가 배포 환경에서 localhost로 생성됨

### 증상
- 로컬에서는 정상이나, 배포 환경에서 문자 링크가 localhost로 고정됨
- 문자 링크 클릭 시 접근 불가

### 원인
- 리마인더 링크 생성 주체가 서버 스케줄러였음
- 서버 실행 환경의 설정값을 그대로 사용하고 있었음

### 해결
- 문자 링크 도메인을 설정 값(`public-base-url`)으로 분리
- 배포/로컬 환경별로 값 분리 관리

### 해결 과정
- 서버 코드 수정 없이도 링크가 변경되지 않는 현상 확인
- 스케줄러 실행 환경 기준이라는 점을 확인
- 설정 분리 후 문제 해결
