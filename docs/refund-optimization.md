# 환불 성능 및 안정성 개선 정리

본 문서는 환불 처리 영역에서 수행한
성능 및 안정성 개선 작업을 정리한 문서이다.
각 항목은 적용 내용, 기대 효과, 측정 지표, 출처를 포함한다.

---

## 1. 환불 정책 계산 서버 단 일원화

### 대상
- 예약 취소 / 환불 API

### 적용 내용
- 환불 금액 계산을 프론트 로직에서 서버 로직으로 이동
- 예약 시각과 취소 시각을 비교하여 환불 비율 산정

### 기대 효과
- 프론트 요청에 따른 불필요한 재계산 및 오류 제거
- 서버 기준 단일 로직으로 환불 처리 안정화

### 측정 지표
- 별도 수치 기록 없음 (정합성/안정성 목적)

### 출처
- `docs/refund-troubleshooting.md`

---

## 2. 외부 결제 취소 선행 처리

### 대상
- 포트원 결제 취소 연동 로직

### 적용 내용
- 외부 결제 취소 성공 후 내부 예약/결제 상태 변경
- 결제 취소 실패 시 트랜잭션 롤백

### 기대 효과
- 결제 상태–예약 상태 불일치로 인한 재처리 비용 방지
- 오류 전파 범위 최소화

### 측정 지표
- 별도 수치 기록 없음 (오류 방지 목적)

### 출처
- `docs/refund-troubleshooting.md`
